---
title:  "æ›´å¥½çš„C#è°ƒç”¨AIçš„æ–¹å¼"
date:   2025-2-10 00:09:00 +0800
tags:
  - C#
  - .NET
  - AI
---

ä½¿ç”¨Microsoft.Extensions.AI.OpenAIæ˜¯ä¸€ç§æ›´å¥½çš„è°ƒç”¨AIçš„æ–¹å¼ã€‚

ä»–ä¹Ÿå¯ä»¥å…¼å®¹å…¶ä»–çš„OpenAIä»¥å¤–çš„æ¨¡å‹ã€‚

```csharp
using TutorialWeb.Interfaces;
using System.ClientModel;
using Microsoft.Extensions.AI;
using TutorialWeb.Models;
using Microsoft.Extensions.Options;

namespace TutorialWeb.Services;

public class DeepSeekAIServiceUsingOpenAIPackage : IAIModelAsync
{
    private string apiKey;

    private string systemPrompt = @"
        ä½ æ˜¯ä¸€ä¸ªèƒ½å¤Ÿå°†æ–‡æœ¬è½¬æ¢ä¸ºemojiè¡¨è¾¾çš„åŠ©æ‰‹ã€‚è¯·æ ¹æ®ä»¥ä¸‹æä¾›çš„å¥å­å’Œå¯¹åº”çš„emojiç¿»è¯‘ï¼Œå­¦ä¹ å¹¶åº”ç”¨ç›¸åŒçš„è§„åˆ™æ¥ç¿»è¯‘æ–°çš„å¥å­ã€‚

        æ ·æœ¬ï¼š
        1.äººå·¥æ™ºèƒ½æ­£åœ¨æ”¹å˜æˆ‘ä»¬çš„ç”Ÿæ´»ï¼Œæœªæ¥ä¼šæœ‰æ›´å¤šåˆ›æ–°ã€‚
        ğŸ¤–â¡ï¸ğŸ”ƒğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ ğŸŒï¼ŒğŸ•™â©â¡ï¸â•ğŸ’¡ğŸš€ğŸ”®ã€‚
        2.æ˜¨æ™šæˆ‘å’Œå¼ ä¸‰ä¸€èµ·åƒäº†ç«é”…ï¼ŒèŠäº†å¾ˆå¤šæœ‰è¶£çš„è¯é¢˜ï¼Œæ„Ÿè§‰æ—¶é—´è¿‡å¾—å¾ˆå¿«ã€‚
        â¬…ï¸â²ï¸ğŸŒƒğŸ§‘â†”ï¸ğŸ‘«ğŸ¥¢ğŸ²ï¼ŒğŸ§‘â†”ï¸ğŸ‘«ğŸ—£ï¸ğŸ’¬ğŸ˜„ï¼ŒğŸ§ ğŸ’­â¡ï¸â³ğŸ•™â©ã€‚
        3.ç«™åœ¨æ³°å±±å±±é¡¶ï¼Œçœ‹ç€è¿œå¤„çš„äº‘å’Œæµ·ï¼Œæ„Ÿè§‰æ•´ä¸ªä¸–ç•Œéƒ½å®‰é™äº†ã€‚
        ğŸ§‘ğŸ”½â›°ï¸=â€æ³°å±±â€ï¼ŒğŸ‘€â¡ï¸ğŸï¸â˜ï¸ğŸŒŠï¼ŒğŸ§ ğŸ’­â¡ï¸ğŸŒâ¡ï¸ğŸ¤«ã€‚
        4.æ¯å¤©åšæŒé”»ç‚¼èº«ä½“ï¼Œä¸ä»…èƒ½ä¿æŒå¥åº·ï¼Œè¿˜èƒ½è®©å¿ƒæƒ…å˜å¥½ã€‚
        ğŸ—“ï¸â¡ï¸ğŸ‹ï¸â€â™‚ï¸ï¼Œâ¡ï¸ğŸ§‘ğŸ’ªï¼Œâ¡ï¸ğŸ§‘ğŸ’­ğŸ˜Šã€‚
        5.å­¦ä¹ ä¸€é—¨æ–°è¯­è¨€éœ€è¦æ—¶é—´å’Œè€å¿ƒï¼Œä½†æœ€ç»ˆä¼šå¾ˆæœ‰æˆå°±æ„Ÿã€‚
        ğŸ§ ğŸ“–â¡ï¸ğŸ—£ï¸ğŸ’¬ğŸ“šâ¡ï¸â•â³â•ğŸ˜Œï¼ŒğŸ•™â­ï¸ğŸ§‘â¡ï¸ğŸ˜†ã€‚
        6.ä»Šå¤©çš„ä¼šè®®å¾ˆé¡ºåˆ©ï¼Œå¤§å®¶éƒ½æå‡ºäº†å¾ˆå¤šå¥½å»ºè®®ã€‚
        ğŸ—“ï¸ğŸ”½ğŸ’¼ğŸ“ŠğŸ’­â¡ï¸âœ…ï¼ŒğŸ‘¥â¡ï¸ğŸ’¡ğŸ’­âœ…ã€‚
        7.ä»Šå¤©å¤©æ°”å¾ˆçƒ­ï¼Œé˜³å…‰ç‰¹åˆ«å¼ºçƒˆï¼Œè®°å¾—å¤šå–æ°´ã€‚
        ğŸ—“ï¸ğŸ”½ğŸŒ¤ï¸â¡ï¸ğŸŒ¡ï¸ï¼Œâ˜€ï¸â¡ï¸ğŸ”¥ï¼ŒğŸ§ ğŸ’­â¡ï¸ğŸ‘„â•ğŸ¥¤ğŸ’§ã€‚
        8.è°¢è°¢ä½ ä¸€ç›´ä»¥æ¥çš„æ”¯æŒï¼Œä½ æ˜¯æˆ‘æœ€å¥½çš„æœ‹å‹ã€‚
        ğŸ™â¡ï¸ğŸ‘¨ğŸ’ªğŸ’–â¡ï¸ğŸ§‘ï¼ŒğŸ‘¨â†”ï¸ğŸ§‘ğŸŸ°ğŸ‘«ğŸ™ŒğŸ¤ã€‚
                                
        ä½ åªéœ€è¦è¿”å›ç¿»è¯‘åçš„emojiè¯­å¥ï¼Œä¸éœ€è¦å›ç­”å…¶ä»–å†…å®¹ã€‚
        ";

    public DeepSeekAIServiceUsingOpenAIPackage(IOptions<AIConfig> config)
    {
        apiKey = config.Value.ApiKey;
    }

    public async Task<string> GenerateAIResponseAsync(string inputText)
    {
        OpenAIChatClient openAIChatClient = new OpenAIChatClient(

        new OpenAI.OpenAIClient(new ApiKeyCredential(apiKey),

        new OpenAI.OpenAIClientOptions() { Endpoint = new Uri("https://api.deepseek.com") }), "deepseek-chat"); 
        var chatMessages = new List<ChatMessage>
        {
            new ChatMessage(ChatRole.System, systemPrompt),
            new ChatMessage(ChatRole.User, inputText)
        }; 

        var reply = await openAIChatClient.CompleteAsync(chatMessages, new ChatOptions() { }); 
        System.Console.WriteLine(reply.Message);
        return reply.Choices[0].Text;
    }
}
```